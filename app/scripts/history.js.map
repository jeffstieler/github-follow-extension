{"version":3,"sources":["../scripts.babel/history.js"],"names":[],"mappings":"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","file":"history.js","sourcesContent":["'use strict';\n/*jshint -W069 */\nvar oauthToken;\nchrome.storage.sync.get({\n    oauthToken: ''\n}, function(items) {\n    oauthToken = items.oauthToken;\n    check();\n});\n\ndocument.addEventListener('DOMNodeInserted', nodeInsertedCallback);\n\nvar timeout;\nfunction nodeInsertedCallback(event) {\n\tvar id = $(event.relatedNode).attr('id');\n\tif (id === 'js-repo-pjax-container') {\n\t\tif (timeout){\n\t\t\tclearTimeout(timeout);\n\t\t}\n    \ttimeout = setTimeout(check, 200);\n\t}\n}\n\nfunction check() {\n\tvar split = $('title').text().split(' - ');\n\tvar ownerRepo = split[1];\n\tvar fileName = split[0].replace('History for ', '');\n\tvar sha = $('clipboard-copy').last().attr('value');\n\tfindMove(sha, fileName, ownerRepo);\n}\n\nfunction findMove(sha, fileName, ownerRepo) {\n\tvar url = 'https://api.github.com/repos/:owner/:repo/commits/:sha'.replace(':sha', sha).replace(':owner/:repo', ownerRepo);\n\tget(url).done(function(data) {\n\t\tvar file = findFile(data.files, fileName);\n\t\tconsole.log(file.status, fileName);\n\t\tif (file.status === 'renamed') {\n\t\t\tvar previousFileName = file['previous_filename'];\n\t\t\tvar parentSha = data.parents[0].sha;\n\t\t\tfollow(parentSha, previousFileName, ownerRepo);\n\t\t}\n\t});\n}\n\nfunction follow(sha, fileName, ownerRepo) {\n\tvar url = 'https://api.github.com/repos/:owner/:repo/commits?sha=:sha&path=:path'\n\t\t.replace(':owner/:repo', ownerRepo)\n\t\t.replace(':sha', sha)\n\t\t.replace(':path', fileName);\n\n\tget(url).done(function(data) {\n\t\tvar fileSha = data[0].sha;\n\t\tvar link = '/:owner/:repo/commits/:sha/:fileName'\n\t\t\t.replace(':owner/:repo', ownerRepo)\n\t\t\t.replace(':sha', fileSha)\n\t\t\t.replace(':fileName', fileName);\n\n\t\t// var iconUrl = chrome.extension.getURL('images/icon-16.png'); \n\t\t// var style = '<style>.icon-follow { background-image: url(:iconUrl); background-position: center center; width:16px; height:16px; display: inline-block;</style>'\n\t\t// \t.replace(':iconUrl', iconUrl);\n\n\t\tvar template = [\n\t\t\t'<div class=\"TimelineItem TimelineItem--condensed\">',\n\t\t\t'<div class=\"TimelineItem-badge\">',\n            '<svg class=\"octicon octicon-git-commit\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M10.5 7.75a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0zm1.43.75a4.002 4.002 0 01-7.86 0H.75a.75.75 0 110-1.5h3.32a4.001 4.001 0 017.86 0h3.32a.75.75 0 110 1.5h-3.32z\"></path></svg>',\n          \t'</div>',\n\t\t\t'<div class=\"TimelineItem-body\">',\n\t\t\t'<h2 class=\"f5 text-normal\">',\n\t\t\t'<strong>Renamed</strong> to :fileName',\n\t\t\t'<a class=\"btn right\" href=\":link\">Follow</a>',\n\t\t\t'</h2>',\n\t\t\t'</div>',\n\t\t\t'</div>'\n\t\t\t].join('')\n\t\t\t.replace(':fileName', fileName)\n\t\t\t.replace(':link', link);\n\n\t\t$('.js-navigation-container.mt-3').append(template);\n\t});\n}\n\nfunction get(url) {\n\n\tvar headers = {\n\t        'Accept':'application/vnd.github.v3+json'\n\t};\n\n\tif (oauthToken) {\n\t\theaders['Authorization'] = 'token ' + oauthToken;\n\t}\n\n    return $.ajax({\n\t    type: 'GET',\n\t    url: url,\n\t    headers: headers\n\t});\n}\n\nfunction findFile(files, fileName) {\n    for (var i = 0, len = files.length; i < len; i++) {\n        if (files[i].filename === fileName) {\n            return files[i];\n        }\n    }\n    return null;\n}"]}